/*
 * This code is for Internal Salesforce use only, and subject to change without notice.
 * Customers shouldn't reference this file in any web pages.
 */

//! Version: 1.3.30   Generated: 2018-11-13 9:51:09 PM GMT

(function(){"use strict";function a(a){return"function"==typeof a||"object"==typeof a&&null!==a}function b(a){return"function"==typeof a}function c(a){S=a}function d(a){W=a}function e(){return function(){process.nextTick(j)}}function f(){return function(){R(j)}}function g(){var a=0,b=new Z(j),c=document.createTextNode("");return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}function h(){var a=new MessageChannel;return a.port1.onmessage=j,function(){a.port2.postMessage(0)}}function i(){return function(){setTimeout(j,1)}}function j(){for(var a=0;V>a;a+=2){var b=aa[a],c=aa[a+1];b(c),aa[a]=void 0,aa[a+1]=void 0}V=0}function k(){try{var a=require,b=a("vertx");return R=b.runOnLoop||b.runOnContext,f()}catch(c){return i()}}function l(a,b){var c=this,d=new this.constructor(n);void 0===d[da]&&G(d);var e=c._state;if(e){var f=arguments[e-1];W(function(){D(e,d,f,c._result)})}else z(c,d,a,b);return d}function m(a){var b=this;if(a&&"object"==typeof a&&a.constructor===b)return a;var c=new b(n);return v(c,a),c}function n(){}function o(){return new TypeError("You cannot resolve a promise with itself")}function p(){return new TypeError("A promises callback cannot return that same promise.")}function q(a){try{return a.then}catch(b){return ha.error=b,ha}}function r(a,b,c,d){try{a.call(b,c,d)}catch(e){return e}}function s(a,b,c){W(function(a){var d=!1,e=r(c,b,function(c){d||(d=!0,b!==c?v(a,c):x(a,c))},function(b){d||(d=!0,y(a,b))},"Settle: "+(a._label||" unknown promise"));!d&&e&&(d=!0,y(a,e))},a)}function t(a,b){b._state===fa?x(a,b._result):b._state===ga?y(a,b._result):z(b,void 0,function(b){v(a,b)},function(b){y(a,b)})}function u(a,c,d){c.constructor===a.constructor&&d===ba&&constructor.resolve===ca?t(a,c):d===ha?y(a,ha.error):void 0===d?x(a,c):b(d)?s(a,c,d):x(a,c)}function v(b,c){b===c?y(b,o()):a(c)?u(b,c,q(c)):x(b,c)}function w(a){a._onerror&&a._onerror(a._result),A(a)}function x(a,b){a._state===ea&&(a._result=b,a._state=fa,0!==a._subscribers.length&&W(A,a))}function y(a,b){a._state===ea&&(a._state=ga,a._result=b,W(w,a))}function z(a,b,c,d){var e=a._subscribers,f=e.length;a._onerror=null,e[f]=b,e[f+fa]=c,e[f+ga]=d,0===f&&a._state&&W(A,a)}function A(a){var b=a._subscribers,c=a._state;if(0!==b.length){for(var d,e,f=a._result,g=0;g<b.length;g+=3)d=b[g],e=b[g+c],d?D(c,d,e,f):e(f);a._subscribers.length=0}}function B(){this.error=null}function C(a,b){try{return a(b)}catch(c){return ia.error=c,ia}}function D(a,c,d,e){var f,g,h,i,j=b(d);if(j){if(f=C(d,e),f===ia?(i=!0,g=f.error,f=null):h=!0,c===f)return void y(c,p())}else f=e,h=!0;c._state!==ea||(j&&h?v(c,f):i?y(c,g):a===fa?x(c,f):a===ga&&y(c,f))}function E(a,b){try{b(function(b){v(a,b)},function(b){y(a,b)})}catch(c){y(a,c)}}function F(){return ja++}function G(a){a[da]=ja++,a._state=void 0,a._result=void 0,a._subscribers=[]}function H(a){return new oa(this,a).promise}function I(a){var b=this;return new b(U(a)?function(c,d){for(var e=a.length,f=0;e>f;f++)b.resolve(a[f]).then(c,d)}:function(a,b){b(new TypeError("You must pass an array to race."))})}function J(a){var b=this,c=new b(n);return y(c,a),c}function K(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function L(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function M(a){this[da]=F(),this._result=this._state=void 0,this._subscribers=[],n!==a&&("function"!=typeof a&&K(),this instanceof M?E(this,a):L())}function N(a,b){this._instanceConstructor=a,this.promise=new a(n),this.promise[da]||G(this.promise),U(b)?(this._input=b,this.length=b.length,this._remaining=b.length,this._result=new Array(this.length),0===this.length?x(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&x(this.promise,this._result))):y(this.promise,O())}function O(){return new Error("Array Methods must be provided an Array")}function P(){var a;if("undefined"!=typeof global)a=global;else if("undefined"!=typeof self)a=self;else try{a=Function("return this")()}catch(b){throw new Error("polyfill failed because global object is unavailable in this environment")}var c=a.Promise;c&&"[object Promise]"===Object.prototype.toString.call(c.resolve())&&!c.cast||(a.Promise=na)}var Q;Q=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)};var R,S,T,U=Q,V=0,W=function(a,b){aa[V]=a,aa[V+1]=b,V+=2,2===V&&(S?S(j):T())},X="undefined"!=typeof window?window:void 0,Y=X||{},Z=Y.MutationObserver||Y.WebKitMutationObserver,$="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),_="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,aa=new Array(1e3);T=$?e():Z?g():_?h():void 0===X&&"function"==typeof require?k():i();var ba=l,ca=m,da=Math.random().toString(36).substring(16),ea=void 0,fa=1,ga=2,ha=new B,ia=new B,ja=0,ka=H,la=I,ma=J,na=M;M.all=ka,M.race=la,M.resolve=ca,M.reject=ma,M._setScheduler=c,M._setAsap=d,M._asap=W,M.prototype={constructor:M,then:ba,"catch":function(a){return this.then(null,a)}};var oa=N;N.prototype._enumerate=function(){for(var a=this.length,b=this._input,c=0;this._state===ea&&a>c;c++)this._eachEntry(b[c],c)},N.prototype._eachEntry=function(a,b){var c=this._instanceConstructor,d=c.resolve;if(d===ca){var e=q(a);if(e===ba&&a._state!==ea)this._settledAt(a._state,b,a._result);else if("function"!=typeof e)this._remaining--,this._result[b]=a;else if(c===na){var f=new c(n);u(f,a,e),this._willSettleAt(f,b)}else this._willSettleAt(new c(function(b){b(a)}),b)}else this._willSettleAt(d(a),b)},N.prototype._settledAt=function(a,b,c){var d=this.promise;d._state===ea&&(this._remaining--,a===ga?y(d,c):this._result[b]=c),0===this._remaining&&x(d,this._result)},N.prototype._willSettleAt=function(a,b){var c=this;z(a,void 0,function(a){c._settledAt(fa,b,a)},function(a){c._settledAt(ga,b,a)})};var pa=P,qa={Promise:na,polyfill:pa};"function"==typeof define&&define.amd?define(function(){return qa}):"undefined"!=typeof module&&module.exports?module.exports=qa:"undefined"!=typeof this&&(this.ES6Promise=qa),pa()}).call(this);var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},scrt;!function(a){var b;!function(a){var b;!function(a){var b=function(a){function b(b){a.call(this,b),this.message=b;var c=(new Error).stack;if(c){var d=c.split("\n");if(d.length>3){c="";for(var e=3;e<d.length;e++)c+=d[e],c+="\n"}this.stack=c}}return __extends(b,a),b}(Error);a.CustomError=b;var c=function(a){function b(b,c,d){a.call(this,"Invalid "+b+" state: expected '"+c+"' actual '"+d+"'")}return __extends(b,a),b}(b);a.InvalidStateError=c}(b=a.errors||(a.errors={}))}(b=a.util||(a.util={}))}(scrt||(scrt={}));var scrt;!function(a){var b;!function(a){var b;!function(b){var c=function(){function b(){this.eventHandlers={}}return b.prototype.addEventListener=function(a,b,c){var d=a.toString();this.eventHandlers.hasOwnProperty(d)||(this.eventHandlers[d]=[]),this.eventHandlers[d].push(new e(c,b))},b.prototype.removeEventListeners=function(a){var b=this;a?Object.keys(this.eventHandlers).forEach(function(c){b.eventHandlers[c]=b.eventHandlers[c].filter(function(b,c){return b.listenerId!=a})}):this.eventHandlers={}},b.prototype.dispatchEvent=function(b,c){a.logging.debug("dispatchEvent eventType: "+b+" data:"+c);var d=this.eventHandlers[b.toString()];d?d.forEach(function(d){try{a.logging.debug("Handler:"+d),d.callback.call(window,c)}catch(e){a.logging.error("Error while handling event "+b.toString()+": "+e.message,e)}}):a.logging.error("No handler found for EventType:"+b.toString())},b.prototype.hasEventListener=function(a){var b=a.toString();return this.eventHandlers.hasOwnProperty(b)&&this.eventHandlers[b].length>0},b}();b.EventTarget=c;var d=function(){function a(a){this.key=a}return a.prototype.toString=function(){return this.key},a}();b.EventType=d;var e=function(){function a(a,b){this.listenerId=a,this.callback=b}return a}()}(b=a.events||(a.events={}))}(b=a.util||(a.util={}))}(scrt||(scrt={}));var scrt;!function(a){var b;!function(a){var b;!function(a){function b(a){return void 0==a?null:a}function c(a){return void 0==a?null:a}a.stringToJson=b,a.numberToJson=c}(b=a.jsonUtil||(a.jsonUtil={}))}(b=a.util||(a.util={}))}(scrt||(scrt={}));var scrt;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(){function b(){}return b.prototype.log=function(b,c,d,e){if(console.log){c=a.util.logging.logLevelToString(b)+": "+c+" ("+a.util.logging.getCaller()+")",b!=a.util.logging.Level.ERROR||d||(d=new Error);var f;switch(b){case a.util.logging.Level.TRACE:f="LightGray";break;case a.util.logging.Level.DEBUG:f="DarkSeaGreen ";break;case a.util.logging.Level.INFO:f="Green";break;case a.util.logging.Level.WARN:f="GoldenRod";break;case a.util.logging.Level.ERROR:f="Red"}console.log("%c"+c,"color: "+f),d&&d.stack&&console.log(d.stack),null!=e&&(console.groupCollapsed?console.groupCollapsed():console.group&&console.group,console.log("%c"+e,"color: "+f),console.groupEnd&&console.groupEnd())}},b.prototype.useLogLevel=function(){return!0},b}();b.ConsoleLogger=c}(c=b.loggers||(b.loggers={}))}(c=b.logging||(b.logging={}))}(b=a.util||(a.util={}))}(scrt||(scrt={}));var scrt;!function(a){var b;!function(b){var c;!function(b){var c;!function(b){var c=function(){function b(){this.loggedRecords=[],this.isConcacted=!1,this.startedTime=(new Date).getTime()}return b.prototype.log=function(c,e,f,g){var h=a.util.logging.getCaller();this.loggedRecords.push(new d(c,(new Date).getTime()-this.startedTime,e,h,f,g)),this.loggedRecords.length>b.MAX_RECORDS&&(this.loggedRecords.shift(),this.isConcacted=!0)},b.prototype.save=function(){var b="";this.isConcacted&&(b+="Log Concactenated\n");var c=new Date;b+="Time: "+c.toString()+"\n",b+="URL: "+window.location.href+"\n",b+="User Agent: "+window.navigator.userAgent+"\n",window.performance.memory&&(b+="Memory: { totalJSHeapSize: "+window.performance.memory.totalJSHeapSize,b+=" usedJSHeapSize: "+window.performance.memory.usedJSHeapSize,b+=" jsHeapSizeLimit: "+window.performance.memory.jsHeapSizeLimit,b+=" }\n"),b+="\nMetrics:\n",a.util.metrics.getAll().forEach(function(a){return b+=a.toString()+"\n"}),b+="\nLog: \n";var d=this.loggedRecords.map(function(a){return a.toString()});d.unshift(b);var e=new Blob(d),f=document.createElement("a");f.download="scrt_log_"+c.getUTCMonth()+"_"+c.getUTCDate()+"_"+c.getUTCFullYear()+"_"+c.getUTCHours()+"_"+c.getUTCMinutes()+"_"+c.getUTCSeconds()+".txt",f.innerHTML="Download Log",f.href=window.URL.createObjectURL(e),f.style.display="none",window.document.body.appendChild(f),f.click()},b.prototype.useLogLevel=function(){return!1},b.MAX_RECORDS=1e3,b}();b.MemoryLogger=c;var d=function(){function b(b,c,d,e,f,g){this.level=b,this.msg=d,this.caller=e,this.cause=f,this.additionalData=g,b!=a.util.logging.Level.ERROR||f||(this.cause=new Error),this.offsetTime=c}return b.prototype.toString=function(){var b="["+this.offsetTime+"] "+a.util.logging.logLevelToString(this.level)+": "+this.msg+" ("+this.caller+")";return this.cause&&this.cause.stack&&(b+="\n",b+=this.cause.stack),null!=this.additionalData&&(b+="\n - Additional Data:",b+=this.additionalData),b+"\n"},b}()}(c=b.loggers||(b.loggers={}))}(c=b.logging||(b.logging={}))}(b=a.util||(a.util={}))}(scrt||(scrt={}));var scrt;!function(a){var b;!function(b){var c;!function(b){function c(a,b){"function"==typeof a?l(o.ERROR,a,b):"string"==typeof a&&l(o.ERROR,function(){return a},b)}function d(a,b){"function"==typeof a?l(o.WARN,a,b):"string"==typeof a&&l(o.WARN,function(){return a},b)}function e(a){"function"==typeof a?l(o.INFO,a):"string"==typeof a&&l(o.INFO,function(){return a})}function f(a){"function"==typeof a?l(o.DEBUG,a):"string"==typeof a&&l(o.DEBUG,function(){return a})}function g(a,b){"function"==typeof a?l(o.TRACE,a,null,b):"string"==typeof a&&l(o.TRACE,function(){return a},null,b)}function h(a){p=a}function i(a){r.push(a)}function j(a){r=r.filter(function(b){return a!==b})}function k(){q.save()}function l(a,b,c,d){r.forEach(function(e){(!e.useLogLevel()||p>=a)&&e.log(a,b.call(window),c,d)})}function m(a){switch(a){case o.ERROR:return"ERROR";case o.WARN:return"WARNING";case o.INFO:return"INFO";case o.DEBUG:return"DEBUG";case o.TRACE:return"TRACE"}return""}function n(){var a=new Error;if(a.stack){for(var b=a.stack.split("\n"),c=7;b.length>=c+1;){var d=b[c].trim();if(-1==d.indexOf("(native)"))return d;c++}if(b.length>=8)return b[7].trim()}return""}!function(a){a[a.ERROR=0]="ERROR",a[a.WARN=1]="WARN",a[a.INFO=2]="INFO",a[a.DEBUG=3]="DEBUG",a[a.TRACE=4]="TRACE"}(b.Level||(b.Level={}));var o=b.Level;b.error=c,b.warn=d,b.info=e,b.debug=f,b.trace=g,b.setLevel=h,b.addLogger=i,b.removeLogger=j;var p=o.WARN,q=new a.util.logging.loggers.MemoryLogger,r=[];r.push(new a.util.logging.loggers.ConsoleLogger),r.push(q),b.save=k,b.logLevelToString=m,b.getCaller=n}(c=b.logging||(b.logging={}))}(b=a.util||(a.util={}))}(scrt||(scrt={}));var scrt;!function(a){var b;!function(a){var b;!function(a){function b(a,b){var b=j(a,b);if(k[b])return k[b];var c=new m(b);return k[b]=c,c}function c(a,b){var b=j(a,b);if(k[b])return k[b];var c=new n(b);return k[b]=c,c}function d(a,b,c){var b=j(a,b);if(k[b])return k[b];var d=c?new r(b,c):new q(b);return k[b]=d,d}function e(){return Object.keys(k).map(function(a){return k[a]})}function f(){return e().filter(function(a){return a.metricType==l.COUNTER})}function g(){return e().filter(function(a){return a.metricType==l.HISTOGRAM})}function h(){return e().filter(function(a){return a.metricType==l.GAUGE})}function i(){k={}}function j(a,b){return a+"."+b}var k={};!function(a){a[a.COUNTER=0]="COUNTER",a[a.HISTOGRAM=1]="HISTOGRAM",a[a.GAUGE=2]="GAUGE"}(a.MetricType||(a.MetricType={}));var l=a.MetricType;a.getCounter=b,a.getHistogram=c,a.getGauge=d,a.getAll=e,a.getCounters=f,a.getHistograms=g,a.getGauges=h,a.deleteAll=i;var m=function(){function a(a){this.count=0,this.metricType=l.COUNTER,this.name=a}return a.prototype.increment=function(){this.count++},a.prototype.decrement=function(){this.count--},a.prototype.add=function(a){this.count+=a},a.prototype.getCount=function(){return this.count},a.prototype.toString=function(){return this.name+": { count: "+this.count+" }"},a}(),n=function(){function a(a){this.reservoir=[],this.count=0,this.metricType=l.HISTOGRAM,this.name=a}return a.prototype.update=function(b){if(this.count++,this.reservoir.length<a.MAX_RESERVOIR)this.reservoir.push(b);else{var c=Math.floor(Math.random()*this.count);c<a.MAX_RESERVOIR&&(this.reservoir[c]=b)}},a.prototype.getResults=function(){return new o(this.reservoir,this.count)},a.prototype.toString=function(){return this.name+": {\n"+this.getResults().toString()+"\n}"},a.MAX_RESERVOIR=1028,a}(),o=function(){function a(a,b){this.sorted=a.slice(),this.sorted.sort(function(a,b){return a-b}),this.count=b}return a.prototype.getCount=function(){return this.count},a.prototype.getMedian=function(){return this.getQuantile(.5)},a.prototype.get75thPercentile=function(){return this.getQuantile(.75)},a.prototype.get95thPercentile=function(){return this.getQuantile(.95)},a.prototype.get99thPercentile=function(){return this.getQuantile(.99)},a.prototype.getMax=function(){return 0==this.sorted.length?0:this.sorted[this.sorted.length-1]},a.prototype.getMin=function(){return 0==this.sorted.length?0:this.sorted[0]},a.prototype.getMean=function(){if(0==this.sorted.length)return 0;var a=this.sorted.reduce(function(a,b){return a+b},0);return a/this.sorted.length},a.prototype.toString=function(){return"count: "+this.getCount()+"\nmedian: "+this.getMedian()+"\n75th percentile: "+this.get75thPercentile()+"\n95th percentile: "+this.get95thPercentile()+"\n99th percentile: "+this.get99thPercentile()+"\nmax: "+this.getMax()+"\nmin: "+this.getMin()+"\nmean: "+this.getMean()},a.prototype.getQuantile=function(a){if(0==this.sorted.length)return 0;if(1==this.sorted.length)return this.sorted[0];var b=a*(this.sorted.length+1);if(1>b)return this.sorted[0];if(b>=this.sorted.length)return this.sorted[this.sorted.length-1];var c=this.sorted[Math.floor(b)-1],d=this.sorted[Math.floor(b)];return c+(b-Math.floor(b))*(d-c)},a}(),p=function(){function a(a){this.name=a}return a.prototype.toString=function(){return this.name+": {\n"+this.getValue().toString()+"\n}"},a}(),q=function(a){function b(b){a.call(this,b),this.metricType=l.GAUGE,this.value=0}return __extends(b,a),b.prototype.update=function(a){this.value=a},b.prototype.getValue=function(){return this.value},b}(p),r=function(a){function b(b,c){a.call(this,b),this.metricType=l.GAUGE,this.provider=c}return __extends(b,a),b.prototype.update=function(a){throw new Error("You cannot update a Gauge created with a provider")},b.prototype.getValue=function(){return this.provider()},b}(p)}(b=a.metrics||(a.metrics={}))}(b=a.util||(a.util={}))}(scrt||(scrt={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},scrt;!function(a){var b;!function(a){var b=function(){function a(a,b,c,d){this.apiVersion=a,this.method=b,this.sessionKey=c,this.params=d}return a.prototype.getHeaders=function(){var a=[new d("X-LIVEAGENT-API-VERSION",this.apiVersion)];return this.sessionKey&&a.push(new d("X-LIVEAGENT-SESSION-KEY",this.sessionKey)),a},a.prototype.getMethodString=function(){if(this.method==c.GET)return"GET";if(this.method==c.POST)return"POST";if(this.method==c.DELETE)return"DELETE";throw new Error("Unknown method: "+this.method)},a.prototype.getUrlPart=function(){var a=this.getBaseUrl();if(this.params){var b,c=!1;for(b in this.params)this.params.hasOwnProperty(b)&&(c?a+="&":(a+="?",c=!0),a+=encodeURIComponent(b)+"="+encodeURIComponent(this.params[b]))}return a},a.prototype.getBody=function(){return null},a.prototype.expectError=function(){return!1},a}();a.Request=b,function(a){a[a.POST=0]="POST",a[a.GET=1]="GET",a[a.DELETE=2]="DELETE"}(a.Method||(a.Method={}));var c=a.Method,d=function(){function a(a,b){this.name=a,this.value=b}return a}();a.HeaderImpl=d}(b=a.connection||(a.connection={}))}(scrt||(scrt={}));var scrt;!function(a){var b;!function(b){var c;!function(c){var d=function(a){function c(b,c,d,e,f,g){a.call(this,b,d,f,g),this.sequence=e,this.noun=c}return __extends(c,a),c.prototype.getBaseUrl=function(){var a=this,c=this.noun.nounPrefix+"/"+this.noun.nounName;if(this.method==b.Method.GET&&this.noun.properties){var d=!1;Object.keys(this.noun.properties).forEach(function(b){c+=d?"&":"?",c+=encodeURIComponent(a.noun.nounName+"."+b),c+="=",c+=encodeURIComponent(a.noun.properties[b])})}return c},c.prototype.getHeaders=function(){var d=a.prototype.getHeaders.call(this);return this.sequence&&d.push(new b.HeaderImpl(c.SEQUENCE_HEADER,this.sequence.toString(10))),d},c.prototype.getBody=function(){return this.method!=b.Method.GET?null==this.noun.properties?null:JSON.stringify(this.noun.properties):null},c.SEQUENCE_HEADER="X-LIVEAGENT-SEQUENCE",c}(a.connection.Request);c.NounRequest=d}(c=b.requests||(b.requests={}))}(b=a.connection||(a.connection={}))}(scrt||(scrt={}));var scrt;!function(a){var b;!function(b){var c=a.util.logging,d=function(d){function g(b,c,e){d.call(this),this.state=f.UNINITIALIZED,this.eventOffSet=0,this.expectedNextSequence=0,this.pollCount=0,this.durationMetrics=a.util.metrics.getHistogram("platform","pollDuration"),this.reconnectMetrics=a.util.metrics.getCounter("platform","pollReconnects"),this.timeoutMetrics=a.util.metrics.getCounter("platform","pollTimeouts"),this.fatalErrorMetrics=a.util.metrics.getCounter("platform","pollFatalErrors"),this.lastPollStart=0,this.maxReconnectMS=12e4,this.apiVersion=b,this.session=c,this.messenger=e}return __extends(g,d),g.prototype.start=function(){if(this.state!=f.UNINITIALIZED)throw new Error("You cannot start an already started long poll loop!");c.info("Beginning long poll loop"),this.state=f.POLLING,this.doPoll()},g.prototype.pausePolling=function(){c.warn("Pausing polling. Setting PollingState to PAUSED. Current State is:"+this.state),window.clearTimeout(this.pollTimeoutId),window.clearTimeout(this.reconnectTimeoutId),this.pollTimeoutId=null,this.state=f.PAUSED},g.prototype.resumePolling=function(a){c.warn("Resuming polling. Setting PollingState to POLLING and calling doPoll."),a&&(c.warn("Reset Sequence:"+a),this.expectedNextSequence=0),this.state=f.POLLING,this.doPoll()},g.prototype.stop=function(){this.state!=f.UNINITIALIZED&&(this.state=f.UNINITIALIZED,window.clearTimeout(this.pollTimeoutId),this.messenger.abort(this.currentPollMessageId))},g.prototype.getState=function(){return this.state},g.prototype.getEventOffSet=function(){return this.eventOffSet},g.prototype.doPoll=function(){var d=this;if(this.state!=f.POLLING&&this.state!=f.RECONNECTING)return void c.warn("Exiting long poll loop: state is "+this.state);var g=new e(this.apiVersion,this.session,this.state==f.RECONNECTING,this.expectedNextSequence-1,this.pollCount);this.pollCount++;var h=this.messenger.send(g,this.session.affinityToken);return this.lastPollStart=(new Date).getTime(),h.then(function(a){d.durationMetrics.update((new Date).getTime()-d.lastPollStart),a.getMessageId()==d.currentPollMessageId?(window.clearTimeout(d.pollTimeoutId),d.pollTimeoutId=null,d.state==f.RECONNECTING&&(c.info("Successfully re-established connection."),d.state=f.POLLING,d.sequentialPollTimeoutCount=0,d.dispatchEvent(b.Events.RECONNECTED,null),window.clearTimeout(d.reconnectTimeoutId)),d.state==f.POLLING&&(d.handlePollResult(a)?d.doPoll():d.fatalError("Unknown successful response type: "+a.getStatus()+": "+a.getData()))):c.warn("Received poll result for poll request "+a.getMessageId()+" while polling for "+d.currentPollMessageId)},function(e){if(d.durationMetrics.update((new Date).getTime()-d.lastPollStart),window.clearTimeout(d.pollTimeoutId),d.pollTimeoutId=null,e instanceof a.connection.messenger.HttpError){c.error("Received bad poll response. Retrying. Error: "+e.message,e);var f=e.status;if(c.debug("status code: "+f),403==f)return d.pausePolling(),void d.dispatchEvent(b.Events.RECONNECT,null);if(409==f)return void d.fatalError("Session out of sync");if(400==f||404==f||405==f||500==f)return void d.fatalError("fata error status:"+e.message);if(503==f)return c.warn("Service Unavailable received while polling. Pausing polling and dispatching Events.SERVICE_UNAVAILABLE Event."),d.pausePolling(),void d.dispatchEvent(b.Events.SERVICE_UNAVAILABLE,null);d.startReconnect(),window.setTimeout(function(){return d.doPoll()},1e3)}else d.fatalError("Unknown error type: "+e,e)}),this.currentPollMessageId=h.messageId,this.pollTimeoutId?void c.error("Unexpected poll while pollTimeout exists. Shutting down loop."):void(this.pollTimeoutId=window.setTimeout(function(){return d.handleTimeout()},1e3*this.session.pollTimeout))},g.prototype.serialize=function(){return{expectedNextSequence:this.expectedNextSequence,pollCount:this.pollCount}},g.prototype.deserialize=function(a){this.expectedNextSequence=a.expectedNextSequence,this.pollCount=a.pollCount},g.prototype.setConnectionTimeout=function(a){this.maxReconnectMS=a},g.prototype.getConnectionTimeout=function(){return this.maxReconnectMS},g.prototype.handlePollResult=function(a){var d=this;if(204==a.getStatus())return c.debug("Received 204: NO CONTENT from long poll. Re-polling."),this.dispatchEvent(b.Events.LONG_POLL_COMPLETED,null),!0;if(200==a.getStatus()){var e=a.getData().sequence;return e=e-a.getData().messages.length+1,a.getData().offset&&(this.eventOffSet=a.getData().offset),a.getData().messages.forEach(function(a){return e<d.expectedNextSequence?void c.info("Discarding duplicate sequence "+e):e>d.expectedNextSequence?void d.fatalError("Out of sync sequence. Expected "+d.expectedNextSequence+" received "+e):(e++,d.expectedNextSequence=e,c.info("Received message: "+a.type),c.trace(function(){return"Message Content: "},JSON.stringify(a.message,null,3)),void d.dispatchEvent(g.Events.RAW_MESSAGE_RECEIVED,a))}),!0}return!1},g.prototype.startReconnect=function(){var a=this;this.state==f.POLLING&&(this.reconnectMetrics.increment(),this.state=f.RECONNECTING,this.dispatchEvent(b.Events.RECONNECTING,null),this.reconnectTimeoutId=window.setTimeout(function(){return a.handleReconnectTimeout()},this.getConnectionTimeout()))},g.prototype.handleReconnectTimeout=function(){this.fatalError("Reconnect timed out after "+this.getConnectionTimeout()+"ms")},g.prototype.handleTimeout=function(){var a=this;this.timeoutMetrics.increment(),this.durationMetrics.update((new Date).getTime()-this.lastPollStart),this.state!=f.UNINITIALIZED&&(c.warn("Client long poll did not complete in "+this.session.pollTimeout+" seconds. Attempting to re-establish connection."),this.sequentialPollTimeoutCount++,this.messenger.abort(this.currentPollMessageId),this.pollTimeoutId=null,this.startReconnect(),this.sequentialPollTimeoutCount>5?window.setTimeout(function(){a.doPoll()},2e3):this.doPoll())},g.prototype.fatalError=function(a,d){this.fatalErrorMetrics.increment(),c.error(a,d),this.state=f.ERROR,this.dispatchEvent(b.Events.FATAL_ERROR,{message:a})},g.Events={RAW_MESSAGE_RECEIVED:new a.util.events.EventType("rawMessageReceived")},g}(a.util.events.EventTarget);b.LongPollLoop=d;var e=function(b){function c(c,d,e,f,g){var h={ack:f.toString(10),pc:g.toString(10)};e&&(h.reconnect="true"),b.call(this,c,new a.connection.nouns.Messages,a.connection.Method.GET,null,d.sessionKey,h)}return __extends(c,b),c}(a.connection.requests.NounRequest);!function(a){a[a.UNINITIALIZED=0]="UNINITIALIZED",a[a.POLLING=1]="POLLING",a[a.RECONNECTING=2]="RECONNECTING",a[a.ERROR=3]="ERROR",a[a.PAUSED=4]="PAUSED"}(b.PollingState||(b.PollingState={}));var f=b.PollingState}(b=a.connection||(a.connection={}))}(scrt||(scrt={}));var scrt;!function(a){var b;!function(a){var b=function(){function a(a,b){this.messagePrefix=a,this.messageName=b}return a.prototype.toString=function(){return this.messagePrefix?this.messagePrefix+"/"+this.messageName:this.messageName},a.prototype.equals=function(b){if(b instanceof a){var c=b;return c.messagePrefix==this.messagePrefix&&c.messageName==this.messageName}return!1},a}();a.MessageType=b}(b=a.connection||(a.connection={}))}(scrt||(scrt={}));var scrt;!function(a){var b;!function(b){var c=function(){function c(){}return c.isMetricNoun=function(b){return a.util.logging.debug("MetricsStorage:      isMetricNoun : "+("System"===b.nounPrefix&&"UiMetrics"===b.nounName)),"System"===b.nounPrefix&&"UiMetrics"===b.nounName},c.getStoredMetrics=function(){return localStorage.getItem(c.STORED_METRICS_KEY)?JSON.parse(localStorage.getItem(c.STORED_METRICS_KEY)):null},c.storeMetrics=function(d){c.isMetricNoun(d)&&!c.isAlreadyStored(d)&&(c.allowInvalidMetrics||b.MetricsUploader.areMetricsValid(d)?(a.util.logging.debug("MetricsStorage:      "+(c.hasStoredMetrics()?"Replacing":"Storing")+" metrics in localstorage"),localStorage.setItem(c.STORED_METRICS_KEY,JSON.stringify(d))):a.util.logging.debug("MetricsStorage:      ignoring invalid metrics for storage"))},c.hasStoredMetrics=function(){a.util.logging.debug("MetricsStorage:      hasAnyStoredMetrics : "+(null!=c.getStoredMetrics()));var d=c.getStoredMetrics();return c.allowInvalidMetrics||b.MetricsUploader.areMetricsValid(d)?(a.util.logging.debug("MetricsStorage:      hasValidStoredMetrics : "+(null!=c.getStoredMetrics())),null!=c.getStoredMetrics()):(a.util.logging.debug("MetricsStorage: removing invalid stored metrics  ..."),c.clearStoredMetrics(),!1)},c.isAlreadyStored=function(b){var d=JSON.stringify(c.getStoredMetrics()),e=JSON.stringify(b);return a.util.logging.debug("MetricsStorage:      isAlreadyStored : "+(d==e)),d==e},c.removeStoredMetrics=function(b){c.isAlreadyStored(b)&&(a.util.logging.debug("MetricsStorage:      Removing stored metric"),c.clearStoredMetrics())},c.clearStoredMetrics=function(){a.util.logging.debug("MetricsStorage:      clearing storedMetrics "),localStorage.removeItem(c.STORED_METRICS_KEY)},c.STORED_METRICS_KEY="storedMetrics",c.allowInvalidMetrics=!1,c}();b.MetricsStorage=c}(b=a.connection||(a.connection={}))}(scrt||(scrt={}));var scrt;!function(a){var b;!function(b){var c=function(){function c(){this.timeoutId=null}return c.getTimeoutSeconds=function(){return c.timeoutMS/1e3},c.setTimeoutMS=function(b){c.timeoutMS=b,a.util.logging.debug("MetricsUploader: setting timeout to "+c.timeoutMS/1e3+" seconds")},c.setTimeoutMultiplier=function(b){c.timeoutMultiplier=b,a.util.logging.debug("MetricsUploader: setting timeout multiplier to "+c.timeoutMultiplier)},c.isStringValid=function(a){return!(null==a)&&""!==a},c.isNumberValid=function(a){return!(null==a||isNaN(a))},c.arePropertiesValid=function(a){return null==a?!1:c.isStringValid(a.sessionId)},c.areGaugesValid=function(a){if(null==a)return!1;for(var b=0;b<a.length;b++){var d=a[b];if(!c.isNumberValid(d.value))return!1;if(!c.isStringValid(d.name))return!1}return!0},c.areCountersValid=function(a){if(null==a)return!1;for(var b=0;b<a.length;b++){var d=a[b];if(!c.isNumberValid(d.value))return!1;if(!c.isStringValid(d.name))return!1}return!0},c.areHistogramsValid=function(a){if(null==a)return!1;for(var b=0;b<a.length;b++){var d=a[b];if(!c.isStringValid(d.name))return!1;if(!c.isNumberValid(d.count))return!1;if(!c.isNumberValid(d.median))return!1;if(!c.isNumberValid(d.mean))return!1;if(!c.isNumberValid(d.min))return!1;if(!c.isNumberValid(d.max))return!1;if(!c.isNumberValid(d.percentile75th))return!1;if(!c.isNumberValid(d.percentile95th))return!1;if(!c.isNumberValid(d.percentile99th))return!1}return!0},c.areMetricsValid=function(a){return null==a?!1:c.arePropertiesValid(a.properties)&&c.areGaugesValid(a.properties.gauges)&&c.areCountersValid(a.properties.counters)?!!c.areHistogramsValid(a.properties.histograms):!1},c.prototype.start=function(b){var d=this;this.session=b,a.util.logging.info("MetricsUploader started, scheduled for "+c.getTimeoutSeconds()+" seconds out"),this.timeoutId=window.setTimeout(function(){return d.upload(!0)},c.timeoutMS)},c.prototype.stop=function(){a.util.logging.debug("MetricsUploader: initiating stop"),window.clearTimeout(this.timeoutId),this.timeoutId=null,this.upload(!1),a.util.logging.info("MetricsUploader: stopped")},c.prototype.upload=function(d){var e=this,f=null,g=c.timeoutMultiplier;if(null!=this.session&&null!=this.session.sessionId&&""!==this.session.sessionId){if(f=this.createNoun(a.util.metrics.getCounters(),a.util.metrics.getHistograms(),a.util.metrics.getGauges(),this.session.sessionId),f.properties.isFinal=!d,b.MetricsStorage.hasStoredMetrics()){var h=b.MetricsStorage.getStoredMetrics();a.util.logging.info("MetricsUploader: trying to upload stored metric ...");var i=a.connection.getConnection().send(h);i.then(function(a){b.MetricsStorage.removeStoredMetrics(h)})["catch"](function(b){a.util.logging.info("Failed to upload stored metrics")})}if(null!==f)if(c.areMetricsValid(f)){a.util.logging.debug("MetricsUploader: trying to send metric ...");var j=a.connection.getConnection().send(f);j.then(function(b){a.util.logging.debug("Sent successfully")})["catch"](function(d){a.util.logging.debug("Failed to upload metrics"),b.MetricsStorage.storeMetrics(f),e.timeoutId=window.setTimeout(function(){return e.upload(!0)},c.timeoutMS)})}else a.util.logging.info("MetricsUploader: suppressing invalid metrics ... "+JSON.stringify(f));a.util.logging.info("MetricsUploader uploaded metrics")}else g=1;d&&(a.util.logging.debug("MetricsUploader scheduled for "+c.getTimeoutSeconds()*g+" seconds out"),this.timeoutId=window.setTimeout(function(){return e.upload(!0)},c.timeoutMS*g))},c.prototype.createNoun=function(b,c,d,e){var f=new a.connection.nouns.UiMetrics;return f.properties.sessionId=e,f.properties.counters=b.map(function(b){var c=new a.connection.nouns.UiMetricsCounter;return c.name=b.name,
c.value=b.getCount(),c}),f.properties.histograms=c.map(function(b){var c=new a.connection.nouns.UiMetricsHistogram;c.name=b.name;var d=b.getResults();return c.count=d.getCount(),c.median=d.getMedian(),c.mean=d.getMean(),c.min=d.getMin(),c.max=d.getMax(),c.percentile75th=d.get75thPercentile(),c.percentile95th=d.get95thPercentile(),c.percentile99th=d.get99thPercentile(),c}),f.properties.gauges=d.map(function(b){var c=new a.connection.nouns.UiMetricsGauge;return c.name=b.name,c.value=b.getValue(),c}),f},c.ONE_MINUTE=6e4,c.timeoutMS=c.ONE_MINUTE,c.timeoutMultiplier=5,c}();b.MetricsUploader=c}(b=a.connection||(a.connection={}))}(scrt||(scrt={}));var scrt;!function(a){var b;!function(b){var c=a.util.logging,d=function(d){function h(b,e,f){d.call(this),this.toSend=[],this.isSending=!1,this.outboundAckPending={},this.outboundAckReceived={},this.outboundSequence=1,this.timeoutCount=0,this.state=g.READY,this.synchronousDurationMetrics=a.util.metrics.getHistogram("platform","sendSynchronousDuration"),this.asynchronousDurationMetrics=a.util.metrics.getHistogram("platform","sendAsynchronousDuration"),this.queueDurationMetrics=a.util.metrics.getHistogram("platform","sendQueueDuration"),this.failedNounMetrics=a.util.metrics.getCounter("platform","sendFailedNouns"),this.reconnectMetrics=a.util.metrics.getCounter("platform","sendReconnects"),this.maxReconnectMS=12e4,this.messenger=b,this.apiVersion=e,this.session=f,c.info("QueueingSender() for session: "+this.session.sessionId)}return __extends(h,d),h.prototype.send=function(a,b){var d=this;c.info("QueueSender.send noun"+a);var f=new Promise(function(f,g){var h=new e(a,b,f,g,d.outboundSequence++);c.trace("Queueing noun "+h.getDebugLabel()+" for send"),d.toSend.push(h),d.sendCheck()});return f},h.prototype.resolveAsync=function(a){var b=this.outboundAckPending[a];b?(c.info("Resolving sequence "+a+" with async success"),this.asynchronousDurationMetrics.update((new Date).getTime()-b.sentTime),b.resolve(null),delete this.outboundAckPending[a]):(c.debug("Received async success result before saving promise. Saving until ready. Sequence: "+a),this.outboundAckReceived[a]=new f(!0))},h.prototype.rejectAsync=function(a,b){var d=this.outboundAckPending[a];d?(this.asynchronousDurationMetrics.update((new Date).getTime()-d.sentTime),d.reject(b),c.info("Rejecting sequence "+a+" with async failure: "+b),delete this.outboundAckPending[a]):(c.debug("Received async failure result before saving promise. Saving until ready. Sequence: "+a+". Error: "+b),this.outboundAckReceived[a]=new f(!1,b))},h.prototype.getState=function(){return this.state},h.prototype.stop=function(){this.state!=g.STOPPED&&(this.state=g.STOPPED,this.currentlySending&&this.currentlySending.length>0&&(this.messenger.abort(this.currentSendMessageId),window.clearTimeout(this.sendTimeoutId),this.toSend.forEach(function(a){c.debug("QueueSender.stop: Noun queued:"+a.noun.nounName)})))},h.prototype.pauseQueueing=function(){c.warn("pauseQueueing. Current State:"+this.state),this.stop(),this.state=g.SERVICE_UNAVAILABLE,this.requeueCurrentlySending()},h.prototype.resumeQueueing=function(){c.warn("resumeQueueing. Previous State"),this.state=g.READY,this.sendCheck()},h.prototype.resetSequence=function(){var a=this;this.isSending&&(window.clearTimeout(this.sendTimeoutId),this.isSending=!1,this.messenger.abort(this.currentSendMessageId),this.currentSendMessageId=null,this.requeueCurrentlySending()),this.outboundSequence=1,this.toSend.forEach(function(b){b.sequence=a.outboundSequence++}),this.sendCheck()},h.prototype.serialize=function(){var a=this;return{toSend:this.currentlySending?this.toSend.concat(this.currentlySending).map(function(a){return a.serialize()}):this.toSend.map(function(a){return a.serialize()}),outboundAckPending:Object.keys(this.outboundAckPending).map(function(b){return a.outboundAckPending[b]}).map(function(a){return a.serialize()}),outboundAckReceived:Object.keys(this.outboundAckReceived).map(function(b){return a.outboundAckReceived[b]}).map(function(a){return a.serialize()}),outboundSequence:this.outboundSequence}},h.prototype.deserialize=function(a){var b=this;this.toSend=a.toSend.map(function(a){return e.deserialize(a)}),this.outboundAckPending={},a.outboundAckPending.map(function(a){return e.deserialize(a)}).forEach(function(a){return b.outboundAckPending[a.sequence]=a}),this.outboundAckReceived={},a.outboundAckReceived.map(function(a){return e.deserialize(a)}).forEach(function(a){return b.outboundAckReceived[a.sequence]=a}),this.outboundSequence=a.outboundSequence,this.sendCheck()},h.prototype.setConnectionTimeout=function(a){this.maxReconnectMS=a},h.prototype.getConnectionTimeout=function(){return this.maxReconnectMS},h.prototype.sendCheck=function(){var b=this;if(this.state==g.STOPPED||this.state==g.ERROR||this.state==g.SERVICE_UNAVAILABLE)return void c.trace("Returning from sendCheck. Current state is:"+this.state);if(this.isSending)return void c.trace("Send already in progress.");if(1==this.toSend.length){this.isSending=!0;var d=this.toSend.pop();this.currentlySending=[d],c.info("Sending one noun now "+d.getDebugLabel()+", sequence: "+d.sequence),c.trace(function(){return"Noun content: "},JSON.stringify(d.noun.properties,function(a,b){return d.noun.sensitiveProperties&&d.noun.sensitiveProperties.hasOwnProperty(a)?"<<< filtered >>>":b},3)),this.sendTimeoutId=window.setTimeout(function(){return b.handleTimeout()},h.TIMEOUT_MS);var e=(new Date).getTime();this.lastSendStarted=e,d.sentTime=e,this.queueDurationMetrics.update(e-d.queuedTime);var f=this.messenger.send(new a.connection.requests.NounRequest(this.apiVersion,d.noun,d.method,d.sequence,this.session.sessionKey),this.session.affinityToken);f.then(this.createResponseHandler(),this.createErrorHandler()),this.currentSendMessageId=f.messageId}else if(this.toSend.length>1){for(var i=[];this.toSend.length>0;)i.push(this.toSend.shift());var j=new a.connection.nouns.MultiNoun;j.properties.nouns=i.map(function(b){var c=new a.connection.nouns.MultiNounPropertiesNounWrapper;return c.prefix=b.noun.nounPrefix,c.noun=b.noun.nounName,c.object=b.noun.properties,c}),this.isSending=!0,this.currentlySending=i,c.info("Sending multinoun consisting of "+i.length+" nouns:");var e=(new Date).getTime();i.forEach(function(a,d){c.info("Noun "+d+" of "+i.length+": "+a.getDebugLabel()+", sequence: "+a.sequence),c.trace(function(){return"Noun content: "},JSON.stringify(a.noun.properties,function(b,c){return a.noun.sensitiveProperties&&a.noun.sensitiveProperties.hasOwnProperty(b)?"<<< filtered >>>":c},3)),a.sentTime=e,b.queueDurationMetrics.update(e-a.queuedTime)}),this.sendTimeoutId=window.setTimeout(function(){return b.handleTimeout()},h.TIMEOUT_MS),this.lastSendStarted=e;var f=this.messenger.send(new a.connection.requests.NounRequest(this.apiVersion,j,a.connection.Method.POST,i[i.length-1].sequence,this.session.sessionKey),this.session.affinityToken);f.then(this.createResponseHandler(),this.createErrorHandler()),this.currentSendMessageId=f.messageId}},h.prototype.handleTimeout=function(){c.debug("Timeout when sending message with sequence "+this.currentlySending[0].sequence+" messageId:"+this.currentSendMessageId+" sessionId:"+this.session.sessionId),this.timeoutCount++,this.messenger.abort(this.currentSendMessageId),this.timeoutCount>=this.getConnectionTimeout()/h.TIMEOUT_MS?(c.error("Maximum timeouts exceeded in send. Fatal error"),this.state=g.ERROR,this.dispatchEvent(b.Events.FATAL_ERROR,{message:"Maximum timeouts exceeded in send"})):(this.timeoutCount<=1&&(c.debug("this.timeoutCount <= 1"),this.state=g.RECONNECTING,this.dispatchEvent(b.Events.RECONNECTING,null)),this.requeueCurrentlySending(),this.isSending=!1,this.currentlySending=null,this.sendCheck())},h.prototype.requeueCurrentlySending=function(){if(this.currentlySending)for(;this.currentlySending.length>0;){var a=this.currentlySending.pop();this.toSend.unshift(a)}this.currentlySending=null},h.prototype.createResponseHandler=function(){var a=this;return function(d){if(a.synchronousDurationMetrics.update((new Date).getTime()-a.lastSendStarted),window.clearTimeout(a.sendTimeoutId),a.state==g.RECONNECTING&&(a.timeoutCount=0,a.state=g.READY,a.dispatchEvent(b.Events.RECONNECTED,null)),a.currentSendMessageId=null,202==d.getStatus()){if(1==a.currentlySending.length){var e=a.currentlySending[0].sequence;return a.handleAsyncResponse(e,a.currentlySending[0]),c.debug("Waiting for async result from sequence "+e),a.isSending=!1,a.currentlySending=null,void a.sendCheck()}var f=d.getData().ack;f.sort();for(var h=(a.outboundSequence-a.currentlySending.length,f.length-1);h>=0;h--)for(var e=f[h],i=0;i<a.currentlySending.length;i++){var j=a.currentlySending[i];if(e===j.sequence){a.currentlySending[i]=null,a.handleAsyncResponse(e,j),c.debug("Waiting for async result from sequence "+e);break}}if(a.currentlySending=a.currentlySending.filter(function(a){return null!=a}),!(a.currentlySending.length>0))return a.isSending=!1,a.currentlySending=null,void a.sendCheck();c.debug("Received partial async partial success response for sequence "+e)}else c.debug("Received successful response for noun sequence "+a.currentlySending[0].sequence);a.isSending=!1,a.currentlySending.forEach(function(a){try{a.resolve(d)}catch(b){c.error("Error encountered when calling resolve handler for "+a.getDebugLabel(),b)}}),a.currentlySending=null,a.sendCheck()}},h.prototype.handleAsyncResponse=function(a,b){c.trace("Received response indicating async result for noun sequence "+a);var d=this.outboundAckReceived[a];d?(this.asynchronousDurationMetrics.update((new Date).getTime()-b.sentTime),d.isSuccess?b.resolve(null):b.reject(d.error)):this.outboundAckPending[a]=b},h.prototype.createErrorHandler=function(){var d=this;return function(e){if(d.synchronousDurationMetrics.update((new Date).getTime()-d.lastSendStarted),window.clearTimeout(d.sendTimeoutId),d.currentSendMessageId=null,d.isSending=!1,e instanceof a.connection.messenger.HttpError){var f=e.status;if(403==f)return d.pauseQueueing(),void d.dispatchEvent(b.Events.RECONNECT,null);if(400==f||404==f||405==f||500==f||409==f)return d.failNouns(e),d.state=g.ERROR,void d.dispatchEvent(b.Events.FATAL_ERROR,{message:"QueueSender Fatal error: "+e.message});if(503==f)return c.debug("Service Unavailable received in QueueSender. Dispatching Events.SERVICE_UNAVAILABLE Event."),d.pauseQueueing(),void d.dispatchEvent(b.Events.SERVICE_UNAVAILABLE,null);d.storeMetricNouns()}if(c.warn("Unexpected response from server. Retrying. Error: "+e.message,e),d.state==g.READY)d.reconnectMetrics.increment(),d.errorStarted=(new Date).getTime(),d.state=g.RECONNECTING,d.dispatchEvent(b.Events.RECONNECTING,null);else if((new Date).getTime()-d.errorStarted>d.getConnectionTimeout())return d.dispatchEvent(b.Events.FATAL_ERROR,{message:"Reconnect timeout exceeded. Original message: "+e.message}),d.failNouns(e),void window.setTimeout(function(){return d.sendCheck()},1e3);d.requeueCurrentlySending(),window.setTimeout(function(){return d.sendCheck()},1e3)}},h.prototype.failNouns=function(a){var b=this;this.currentlySending.forEach(function(d){b.failedNounMetrics.increment();try{d.reject(a)}catch(e){c.error("Error encountered when calling reject handler for "+d.getDebugLabel(),e),c.error("Suppressed error was ",a)}})},h.prototype.storeMetricNouns=function(){this.currentlySending.forEach(function(a){return b.MetricsStorage.storeMetrics(a.getNoun())})},h.TIMEOUT_MS=2e4,h}(a.util.events.EventTarget);b.QueueingSender=d;var e=function(){function a(a,b,c,d,e){this.noun=a,this.method=b,this.resolve=c,this.reject=d,this.sequence=e,this.queuedTime=(new Date).getTime()}return a.deserialize=function(b){return new a(b.noun,b.method,function(){return null},function(){return null},b.sequence)},a.prototype.serialize=function(){return{method:this.method,noun:this.noun,sequence:this.sequence}},a.prototype.getNoun=function(){return this.noun},a.prototype.getDebugLabel=function(){return this.noun.nounPrefix+"/"+this.noun.nounName},a}(),f=function(){function a(a,b){this.isSuccess=a,this.error=b}return a}();!function(a){a[a.READY=0]="READY",a[a.RECONNECTING=1]="RECONNECTING",a[a.ERROR=2]="ERROR",a[a.STOPPED=3]="STOPPED",a[a.SERVICE_UNAVAILABLE=4]="SERVICE_UNAVAILABLE"}(b.SendingState||(b.SendingState={}));var g=b.SendingState}(b=a.connection||(a.connection={}))}(scrt||(scrt={}));var scrt;!function(a){var b;!function(a){var b=function(){function a(){this.sessionId=null,this.sessionKey=null,this.pollTimeout=null,this.affinityToken=null,this.offset=null}return a.prototype.clear=function(){this.sessionId=null,this.sessionKey=null,this.pollTimeout=null,this.affinityToken=null,this.offset=null},a}();a.Session=b}(b=a.connection||(a.connection={}))}(scrt||(scrt={}));var scrt;!function(a){var b;!function(b){var c=function(){function b(){this.createMemoryMetrics()}return b.prototype.createMemoryMetrics=function(){try{if(window.performance&&window.performance.memory){var b=window.performance.memory;a.util.metrics.getGauge("userAgent","usedJSHeapSize",function(){return b.usedJSHeapSize}),a.util.metrics.getGauge("userAgent","jsHeapSizeLimit",function(){return b.jsHeapSizeLimit}),a.util.metrics.getGauge("userAgent","percentMemoryUsed",function(){return Math.round(b.usedJSHeapSize/b.jsHeapSizeLimit*1e4)/100})}}catch(c){a.util.logging.error("Could not create memory metrics",c)}},b}();new c}(b=a.connection||(a.connection={}))}(scrt||(scrt={}));var scrt;!function(a){var b;!function(b){var c;!function(b){!function(a){a[a.UNINITIALIZED=0]="UNINITIALIZED",a[a.EXTERNAL_CREATION=1]="EXTERNAL_CREATION",a[a.READY=2]="READY"}(b.ExternalState||(b.ExternalState={}));var c=b.ExternalState,d=a.util.logging,e=function(){function e(a,b,d,e){this.sequence=0,this.currentState=c.UNINITIALIZED,this.pendingMessages=[],this.outgoingMessages={},this.abortedMessageIds=[],this.chatUrl=a,this.contentUrl=b,this.apiVersion=d,this.proxyUrl=e}return e.prototype.start=function(){var b=this;if(this.currentState!=c.UNINITIALIZED)throw new a.util.errors.InvalidStateError("ExternalMessenger",c.UNINITIALIZED,this.currentState);return new Promise(function(a,d){b.currentState=c.EXTERNAL_CREATION,b.startResolver=a,b.doStart()})},e.prototype.send=function(a,b){var e=this,h=new f(this.sequence++,a.getHeaders(),b,a.getMethodString(),a.getUrlPart(),a.getBody(),a.expectError()),i=new Promise(function(a,b){var f=new g(h,a,b);e.currentState!=c.READY?(e.pendingMessages.push(f),d.debug("Queueing message before external sender is ready")):e.doSend(f)}),j=i;return j.messageId=h.id,j},e.prototype.abort=function(a){d.debug("Aborting message EXT-"+a),this.pendingMessages=this.pendingMessages.filter(function(b){return b.message.id!=a}),this.outgoingMessages[a]?(d.debug("Deleting message EXT-"+a),delete this.outgoingMessages[a],this.doAbort(a),this.abortedMessageIds.push(a)):d.debug("Message EXT-"+a+" not found to abort")},e.prototype.started=function(){var b=this;if(this.currentState!=c.EXTERNAL_CREATION)throw new a.util.errors.InvalidStateError("ExternalMessenger",c.EXTERNAL_CREATION,this.currentState);this.currentState=c.READY,d.info("External Messenger Initialized"),this.startResolver(),this.pendingMessages.forEach(function(a){return b.doSend(a)}),this.pendingMessages=[]},e.prototype.responseReceived=function(a,c,e,f){var g=this.outgoingMessages[a];if(delete this.outgoingMessages[a],!g){var i=!1;return this.abortedMessageIds=this.abortedMessageIds.filter(function(b){return b==a?(i=!0,!1):!0}),void(i||d.warn("Received reply for unknown message ID: EXT-"+a))}if(c)g.resolve(new h(e,f,a)),d.trace("Received successful result for EXT-"+a);else{g.message.expectError?d.debug("Received "+e+" in external sender from request for "+g.message.urlPart):d.error("Bad result in external sender for EXT-"+a+" from "+g.message.method+" to "+g.message.urlPart+" status code: "+e+": "+f,j);var j=new b.HttpError("Received status code "+e+" from server over external sender: "+f+" for EXT-"+a,e,f);g.reject(j)}},e.prototype.doSend=function(a){d.trace(function(){return"Sending (EXT-"+a.message.id+") "+a.message.urlPart+" via "+a.message.method+" over external interface"}),this.outgoingMessages[a.message.id]=a,this.externalSend(a)},e.AFFINITY_HEADER="X-LIVEAGENT-AFFINITY",e}();b.AbstractExternalMessenger=e;var f=function(){function b(b,c,d,f,g,h,i){this.id=b,this.headers=c,this.method=f,this.urlPart=g,this.data=h,this.expectError=i,this.headers||(this.headers=[]),this.headers.push(new a.connection.HeaderImpl(e.AFFINITY_HEADER,d?d:"null"))}return b}();b.OutgoingMessage=f;var g=function(){function a(a,b,c){this.message=a,this.resolve=b,this.reject=c}return a}();b.OutgoingMessageWrapper=g;var h=function(){function a(a,b,c){this.status=a,this.rawData=b,this.messageId=c}return a.prototype.getStatus=function(){return this.status},a.prototype.getData=function(){if(!this.data)try{this.data=JSON.parse(this.rawData)}catch(a){throw new Error("Unable to parse JSON string: '"+this.data+"'")}return this.data},a.prototype.getRawData=function(){return this.rawData},a.prototype.getMessageId=function(){return this.messageId},a}();b.OutgoingMessageResult=h}(c=b.messenger||(b.messenger={}))}(b=a.connection||(a.connection={}))}(scrt||(scrt={}));var scrt;!function(a){var b;!function(b){var c;!function(b){var c=a.util.logging,d=function(d){function e(){d.apply(this,arguments)}return __extends(e,d),e.prototype.isAvailable=function(){return"undefined"!=typeof window.postMessage},e.prototype.doStart=function(){this.addMessageHook(),this.createIframe()},e.prototype.doAbort=function(a){this.sendToFrame(JSON.stringify({action:"abort",id:a}))},e.prototype.externalSend=function(a){var b=a.message;this.sendToFrame(JSON.stringify({action:"send",async:!0,id:b.id,headers:b.headers,method:b.method,url:this.chatUrl+b.urlPart,data:b.data,expectError:b.expectError}))},e.prototype.sendToFrame=function(a){this.iframe.contentWindow.postMessage(a,"*")},e.prototype.addMessageHook=function(){var a=this;if(window.addEventListener)window.addEventListener("message",function(b){return a.cdmMessageReceived(b)},!1);else{if(!window.attachEvent)throw new Error("Could not attach event listener");window.attachEvent("onmessage",function(b){return a.cdmMessageReceived(b)},!1)}c.debug("Added CDM message hook")},e.prototype.createIframe=function(){var a=this.chatUrl+"/rest/cdm?version="+this.apiVersion+"&redirect=true";this.proxyUrl&&(a+="&proxy="+encodeURIComponent(this.proxyUrl)),this.iframe=document.createElement("iframe"),this.iframe.src=a,this.iframe.style.display="none",document.body.appendChild(this.iframe),c.debug("CDM frame created")},e.prototype.cdmMessageReceived=function(d){if(this.iframe&&d.source==this.iframe.contentWindow){var e=JSON.parse(d.data);if("init"==e.result){var f=e.url;this.chatUrl=f.substr(0,f.indexOf("/rest/cdm"))+"/rest/",c.info("CDM Initialized"),this.started()}else{if(this.currentState!=b.ExternalState.READY)throw new a.util.errors.InvalidStateError("cdm",b.ExternalState.READY,this.currentState);switch(e.result){case"success":this.responseReceived(e.id,!0,e.status,e.data);break;case"error":this.responseReceived(e.id,!1,e.status,e.data);break;default:var g=new Error("Unexpected result: "+e.result);this.responseReceived(e.id,!1,e.status,g.message),c.error("Invalid result to send of EXT-"+e.id+" from CDM",g)}}}},e}(b.AbstractExternalMessenger);b.Cdm=d}(c=b.messenger||(b.messenger={}))}(b=a.connection||(a.connection={}))}(scrt||(scrt={}));var scrt;!function(a){var b;!function(b){var c;!function(b){function c(b,c,e,f){var g=new a.connection.messenger.Cdm(b,c,e,f);if(g.isAvailable())return d.info("Selected CDM messenger"),g;throw new Error("Could not locate an available messenger")}var d=a.util.logging;b.createMessenger=c;var e=function(a){function b(b,c,d){a.call(this,b),this.status=c,this.data=d}return __extends(b,a),b}(a.util.errors.CustomError);b.HttpError=e}(c=b.messenger||(b.messenger={}))}(b=a.connection||(a.connection={}))}(scrt||(scrt={}));var scrt;!function(a){var b;!function(b){var c;!function(b){var c=function(b){function c(c,d){b.call(this,d,a.connection.Method.DELETE,c),this.sessionKeyToDelete=c}return __extends(c,b),c.prototype.getBaseUrl=function(){return"System/SessionId/"+this.sessionKeyToDelete},c}(a.connection.Request);b.SessionDeleteRequest=c}(c=b.requests||(b.requests={}))}(b=a.connection||(a.connection={}))}(scrt||(scrt={}));var scrt;!function(a){var b;!function(b){function c(a,b,c){g=c,j||(j=new l(a,b))}function d(){return null!=j}function e(){return j}function f(a){j&&h.error("Attempting to deserialize with existing connection");var b=JSON.parse(a);g=b.apiVersion;var c=b.serviceUrl,d=b.contentUrl;return j=new l(c,d),j.deserialize(b),j}var g,h=a.util.logging,i=a.util.jsonUtil,j=null;b.initialize=c,b.isInitialized=d,b.getConnection=e,b.deserialize=f;var k=function(){function b(){}return b.RECONNECTING=new a.util.events.EventType("reconnecting"),b.RECONNECTED=new a.util.events.EventType("reconnected"),b.FATAL_ERROR=new a.util.events.EventType("fatalError"),b.MESSAGE_RECEIVED=new a.util.events.EventType("messageReceived"),b.AFFINITY_TOKEN_CHANGED=new a.util.events.EventType("affinityTokenChanged"),b.SERVICE_UNAVAILABLE=new a.util.events.EventType("serviceUnavailable"),b.RECONNECT=new a.util.events.EventType("reconnect"),b.REINIT=new a.util.events.EventType("reinit"),b.LONG_POLL_COMPLETED=new a.util.events.EventType("longPollCompleted"),b}();b.Events=k;var l=function(c){function d(d,e){c.call(this),this.session=new b.Session,this.jsErrorMetrics=a.util.metrics.getCounter("platform","connectionJsErrors"),this.metricsUploader=new b.MetricsUploader;var f=this.getWindowParameter("proxy");this.serviceEndpoint=d,this.contentEndpoint=e,this.messenger=a.connection.messenger.createMessenger(this.serviceEndpoint,this.contentEndpoint,g,f),this.startPromise=this.messenger.start();var i=this;for(var j in this)this[j]instanceof Function&&function(a){var b=this[a];this[a]=function(){try{return b.apply(this,arguments)}catch(c){i.jsErrorMetrics.increment(),h.error("Error while calling scrt.connection."+a+(c.message?": "+c.message:""),c)}}}.call(this,j)}return __extends(d,c),d.prototype.getWindowParameter=function(a){for(var b=window.location.search.substring(1).split("&"),c=0;c<b.length;c++){var d=b[c].split("=");if(d[0]===a&&d.length>1)return this.escapeToHtml(d[1])}return null},d.prototype.escapeToHtml=function(a){return null===a||void 0===a||""===a?"":a.replace(/[&<>"'\u00a9\u2028\u2029]/g,this.htmlEscapeChararacter)},d.prototype.htmlEscapeChararacter=function(a){switch(a){case"'":return"&#39;";case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"©":return"&copy;";case"\u2028":return"<br>";case"\u2029":return"<p>";default:return a}},d.prototype.connect=function(c,d){var e=this;try{return this.sessionPromise=this.startPromise.then(function(){var d={"SessionId.ClientType":c};return e.messenger.send(new a.connection.requests.NounRequest(g,new a.connection.nouns.SessionId,b.Method.GET,null,null,d),null)}).then(function(a){return e.session.sessionId=a.getData().id,e.session.sessionKey=a.getData().key,e.session.pollTimeout=a.getData().clientPollTimeout,e.session.affinityToken=a.getData().affinityToken,h.info("Session "+e.session.sessionId+" initialized with affinity for "+e.session.affinityToken+" and a poll timeout of "+e.session.pollTimeout),e.longPollLoop=new b.LongPollLoop(g,e.session,e.messenger),e.startPolling(),d&&(h.info("this.dispatchEvent(Events.REINIT, null)"),e.dispatchEvent(k.REINIT,null)),h.info("connection.connect: Session ready"),e.metricsUploader.start(e.session),e.session.sessionId})["catch"](function(a){throw h.error("Could not initialize session",a),a}),this.sessionPromise}catch(f){throw h.error("Could not start messenger",f),f}},d.prototype.start=function(a){return this.sessionPromise?this.sessionPromise:this.connect(a,!1)},d.prototype.restart=function(a,c,d,e){var f=this;if(h.info("connection.restart: starting"),this.sessionPromise)throw new Error("You cannot restart an already started session.");this.session.sessionId=a,this.session.sessionKey=c,this.session.affinityToken=d,this.session.pollTimeout=e,h.info("Session "+this.session.sessionId+" restored with affinity for "+this.session.affinityToken+" and a poll timeout of "+this.session.pollTimeout),this.sessionPromise=this.startPromise.then(function(){return f.longPollLoop=new b.LongPollLoop(g,f.session,f.messenger),f.startPolling(),f.metricsUploader.start(f.session),h.info("connection.restart: Session ready"),f.session.sessionId})},d.prototype.reconnect=function(){h.warn("Session invalid. Trying to reconnect. Pausing Polling"),this.longPollLoop.pausePolling(),h.warn("Pausing SendQueue"),this.sendQueue.pauseQueueing(),this.metricsUploader.stop(),this.connect("reconnect",!0)},d.prototype.stop=function(){h.info("connection.stop"),this.abort(),this.messenger.send(new a.connection.requests.SessionDeleteRequest(this.session.sessionKey,g),this.session.affinityToken).then(function(){return h.info("Remote session deleted")}),this.stopped()},d.prototype.stopped=function(){h.info("connection.stopped"),this.abort(),this.session.clear(),this.sessionPromise=null},d.prototype.abort=function(){this.metricsUploader.stop(),this.longPollLoop.stop(),this.sendQueue.stop(),h.info("Connection aborted by request")},d.prototype.send=function(a){return this.sendQueue.send(a,b.Method.POST)},d.prototype.get=function(c){return this.messenger.send(new a.connection.requests.NounRequest(g,c,b.Method.GET,null,this.session.sessionKey),this.session.affinityToken).then(function(a){if(200==a.status)return JSON.parse(a.rawData);throw new Error("Unexpected result: "+JSON.stringify(a))})},d.prototype.getSessionId=function(){return this.session.sessionId},d.prototype.getSessionKey=function(){return this.session.sessionKey},d.prototype.getAffinityToken=function(){return this.session.affinityToken},d.prototype.getMessenger=function(){return this.messenger},d.prototype.getApiVersion=function(){return g},d.prototype.isServiceUnavailable=function(){return this.state==a.connection.Events.SERVICE_UNAVAILABLE},d.prototype.isRunning=function(){return null!=this.session.sessionId},d.prototype.serialize=function(){return JSON.stringify({serviceUrl:i.stringToJson(this.serviceEndpoint),contentUrl:i.stringToJson(this.contentEndpoint),apiVersion:i.stringToJson(g),sessionId:i.stringToJson(this.session.sessionId),sessionKey:i.stringToJson(this.session.sessionKey),affinityToken:i.stringToJson(this.session.affinityToken),pollTimeout:i.numberToJson(this.session.pollTimeout),outgoing:void 0==this.sendQueue?null:this.sendQueue.serialize(),incoming:void 0==this.longPollLoop?null:this.longPollLoop.serialize()})},d.prototype.deserialize=function(a){if(a.apiVersion!=g)throw new Error("Deserialization is not supported across versions. Serialized version: "+a.apiVersion+" expected version: "+g);if(this.session.sessionId)throw new Error("You cannot deserialize a session once the connection has started");this.serviceEndpoint=a.serviceUrl,this.contentEndpoint=a.contentUrl,this.session.sessionId=a.sessionId,this.session.sessionKey=a.sessionKey,this.session.affinityToken=a.affinityToken,this.session.pollTimeout=a.pollTimeout,h.info("Session "+this.session.sessionId+" deserialized with affinity for "+this.session.affinityToken+" and a poll timeout of "+this.session.pollTimeout),this.longPollLoop=new b.LongPollLoop(g,this.session,this.messenger),null!=a.incoming&&this.longPollLoop.deserialize(a.incoming),this.startPolling(),null!=a.outgoing&&this.sendQueue.deserialize(a.outgoing),h.info("Deserialized session ready")},d.prototype.setConnectionTimeout=function(a){this.longPollLoop.setConnectionTimeout(a),this.sendQueue.setConnectionTimeout(a)},d.prototype.startPolling=function(){var c=this;this.addEventListener(k.RECONNECT,function(){return c.reconnect()}),this.longPollLoop.addEventListener(k.LONG_POLL_COMPLETED,function(){return c.dispatchEvent(k.LONG_POLL_COMPLETED,null)}),this.addEventListener(k.SERVICE_UNAVAILABLE,function(){return c.serviceUnavailable()}),this.longPollLoop.addEventListener(k.RECONNECT,function(){return c.reconnect()}),this.longPollLoop.addEventListener(k.SERVICE_UNAVAILABLE,function(){return c.serviceUnavailable()}),this.longPollLoop.addEventListener(b.LongPollLoop.Events.RAW_MESSAGE_RECEIVED,function(a){return c.handleRawMessage(a)}),this.relayEvents(this.longPollLoop,k.MESSAGE_RECEIVED),this.longPollLoop.addEventListener(k.FATAL_ERROR,function(a){c.sendQueue.stop(),c.dispatchEvent(k.FATAL_ERROR,a),c.stopped()}),this.relayEvents(this.longPollLoop,k.RECONNECTING),this.relayEvents(this.longPollLoop,k.RECONNECTED),this.sendQueue=new a.connection.QueueingSender(this.messenger,g,this.session),this.sendQueue.addEventListener(k.SERVICE_UNAVAILABLE,function(){return c.serviceUnavailable()}),this.relayEvents(this.sendQueue,k.FATAL_ERROR),this.sendQueue.addEventListener(k.FATAL_ERROR,function(a){c.longPollLoop.stop(),c.dispatchEvent(k.FATAL_ERROR,a),c.stopped()}),this.longPollLoop.addEventListener(k.RECONNECTING,function(){return c.sendQueue.getState()!=b.SendingState.RECONNECTING?c.dispatchEvent(k.RECONNECTING,null):null}),this.sendQueue.addEventListener(k.RECONNECTING,function(){return c.longPollLoop.getState()!=b.PollingState.RECONNECTING?c.dispatchEvent(k.RECONNECTING,null):null}),this.longPollLoop.addEventListener(k.RECONNECTED,function(){return c.sendQueue.getState()==b.SendingState.READY?c.dispatchEvent(k.RECONNECTED,null):null}),this.sendQueue.addEventListener(k.RECONNECTED,function(){return c.longPollLoop.getState()==b.PollingState.POLLING?c.dispatchEvent(k.RECONNECTED,null):null}),this.hasEventListener(k.AFFINITY_TOKEN_CHANGED)||this.addEventListener(k.AFFINITY_TOKEN_CHANGED,function(a){return c.affinityTokenChanged(a.affinityToken,a.resetSequence)}),this.longPollLoop.start()},d.prototype.serviceUnavailable=function(){var b=this;h.warn("Service Unavailable. Getting new Affinity Token"),this.isServiceUnavailable()||(h.warn("Affinity token changed. Re-syncing. Pausing Polling"),this.longPollLoop.pausePolling(),h.warn("Pausing SendQueue"),this.sendQueue.pauseQueueing(),this.messenger.send(new m(g,this.session,this.longPollLoop.getEventOffSet()),null).then(function(a){if(200==a.getStatus()){var c=a.getData().messages[0].message;h.debug("Received new affinity token: "+c.affinityToken),b.dispatchEvent(k.AFFINITY_TOKEN_CHANGED,c)}else b.fatalError("Invalid result from reconnect session request ["+a.getStatus()+"]: "+a.getRawData())},function(a){b.fatalError("Invalid response to reconnect session request: "+a,a instanceof Error?a:null)}),this.state=a.connection.Events.SERVICE_UNAVAILABLE)},d.prototype.affinityTokenChanged=function(a,b){h.debug("affinityTokenChanged:"+a+". Reset Sequence"+b),b&&this.sendQueue.resetSequence(),this.session.affinityToken=a,h.warn("new Affinity token:"+this.session.affinityToken),this.longPollLoop.resumePolling(b),this.sendQueue.resumeQueueing(),this.state=null},d.prototype.handleRawMessage=function(a){var c,d,e=a.type.split("/");e.length>1?(c=e[0],d=e[1]):d=e[0];var f={type:new b.MessageType(c,d),body:a.message};this.dispatchMessage(f)},d.prototype.dispatchMessage=function(a){var c=this;if(a.type.equals(b.messages.AsyncResultType)){var d=a;d.body.isSuccess?this.sendQueue.resolveAsync(d.body.sequence):this.sendQueue.rejectAsync(d.body.sequence,d.body.error)}else Promise.resolve(a).then(function(a){return c.dispatchEvent(k.MESSAGE_RECEIVED,a)})},d.prototype.relayEvents=function(a,b){var c=this;a.addEventListener(b,function(a){c.dispatchEvent(b,a)})},d.prototype.fatalError=function(a,b){h.error(a,b),this.dispatchEvent(k.FATAL_ERROR,{message:a})},d}(a.util.events.EventTarget),m=function(b){function c(c,d,e){b.call(this,c,new a.connection.nouns.ReconnectSession,a.connection.Method.GET,null,d.sessionKey,{"ReconnectSession.offset":e.toString(10)})}return __extends(c,b),c}(a.connection.requests.NounRequest)}(b=a.connection||(a.connection={}))}(scrt||(scrt={}));var scrt;!function(a){var b;!function(b){var c;!function(b){
var c=function(a){function b(){a.call(this,null,"AsyncResult")}return __extends(b,a),b}(a.connection.MessageType);b.AsyncResultType=new c}(c=b.messages||(b.messages={}))}(b=a.connection||(a.connection={}))}(scrt||(scrt={}));var scrt;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){this.nounPrefix="System",this.nounName="Messages",this.properties=null}return a}();a.Messages=b}(b=a.nouns||(a.nouns={}))}(b=a.connection||(a.connection={}))}(scrt||(scrt={}));var scrt;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){this.nounPrefix="System",this.nounName="MultiNoun",this.properties=new c}return a}();a.MultiNoun=b;var c=function(){function a(){}return a}();a.MultiNounProperties=c;var d=function(){function a(){}return a}();a.MultiNounPropertiesNounWrapper=d}(b=a.nouns||(a.nouns={}))}(b=a.connection||(a.connection={}))}(scrt||(scrt={}));var scrt;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){this.nounPrefix="System",this.nounName="ReconnectSession",this.properties=null}return a}();a.ReconnectSession=b}(b=a.nouns||(a.nouns={}))}(b=a.connection||(a.connection={}))}(scrt||(scrt={}));var scrt;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){this.nounPrefix="System",this.nounName="SessionId",this.properties=null}return a}();a.SessionId=b}(b=a.nouns||(a.nouns={}))}(b=a.connection||(a.connection={}))}(scrt||(scrt={}));var scrt;!function(a){var b;!function(a){var b;!function(a){var b=function(){function a(){this.nounPrefix="System",this.nounName="UiMetrics",this.properties=new c}return a}();a.UiMetrics=b;var c=function(){function a(){this.counters=[],this.histograms=[],this.gauges=[]}return a}();a.UiMetricsProperties=c;var d=function(){function a(){}return a}();a.UiMetricsCounter=d;var e=function(){function a(){}return a}();a.UiMetricsGauge=e;var f=function(){function a(){}return a}();a.UiMetricsHistogram=f}(b=a.nouns||(a.nouns={}))}(b=a.connection||(a.connection={}))}(scrt||(scrt={}));
//# sourceMappingURL=/content/dev/resources/js/scrt.min.js.map